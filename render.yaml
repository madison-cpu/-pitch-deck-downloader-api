services:
  - type: web
    name: pitch-downloader-api-enhanced
    env: python
    region: oregon
    plan: starter
    buildCommand: apt-get update && apt-get install -y xvfb chromium-chromedriver chromium-browser && pip install --upgrade pip && pip install -r requirements.txt
    startCommand: xvfb-run -a gunicorn --bind 0.0.0.0:$PORT --workers 1 --timeout 300 --preload app:app
    healthCheckPath: /health
    envVars:
      - key: MAX_SLIDES
        value: 15
      - key: TIMEOUT
        value: 180
      - key: PYTHONUNBUFFERED
        value: 1
      - key: DISPLAY
        value: ":99"
      - key: XVFB_RUN
        value: "xvfb-run -a"
      - key: CHROME_BIN
        value: "/usr/bin/chromium-browser"
      - key: CHROMEDRIVER_PATH
        value: "/usr/bin/chromedriver"

